#!/usr/bin/ksh

# removed all non relevant output


# Warning on
#         Driver-Firmware Dump Available = NO


# CRIT on 
#	                   Driver state = ONLINE
#                           Topology = PTTOPT_FABRIC


# Just Print			       
#                       ISP Code version = 5.4.4
#	    N_Port Node World Wide Name = 0x50014380120baf51
#	               Hardware Path is = 0/0/0/5/0/0/0

# There might be different hbas in the system.
# add your code if you need that. remember to use the right "util" for the type.

hbas=$( ls /dev/fcd* )
if [ $? = 0 ]; then
    echo '<<<hpux_hbahealth>>>'
else
    exit 0
fi

for hba in /dev/fcd* ; do
    util=/opt/fcms/bin/fcdutil
    echo "$hba"
    $util $hba | grep -e "Driver state" -e "Topology" -e "Dump Available"\
    	              -e "Code version" -e "Hardware Path" -e "Port World"
done
