#!/usr/bin/python

decru_fan_default_levels = (8000, 8400)

def inventory_decru_fans(checkname, info):
    return [ (l[0], l[1] + " RPM", "decru_fan_default_levels") for l in info ]

def check_decru_fans(item, params, info):
    for fan in info:
       if fan[0] == item:
          rpm = int(fan[1])
	  crit, warn = params
	  perfdata = [("rpm", rpm, 0, "", warn, crit)]
          infotxt = " - %d RPM" % rpm
          if rpm < crit: 
	     return (2, "CRIT" + infotxt, perfdata)
          elif rpm < warn:
	     return (1, "WARN" + infotxt, perfdata)
          else:
	     return (0, "OK" + infotxt, perfdata)

    return (3, "UNKNOWN - fan not found")

check_info['decru_fans'] = (check_decru_fans, "FAN %s", 1, inventory_decru_fans)

snmp_info['decru_fans'] = ( "enterprises.12962.1.2.3.1", [ 2, 3 ] )
# snmp_scan_info['decru_fans'] = ( "enterprises.12962.1.1.1.1", "=", "san" )
# oder (SNMPv2-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.12962.2.1.4):
# snmp_scan_info['decru_fans'] = ( ".1.3.6.1.2.1.1.2.0", "=", ".1.3.6.1.4.1.12962.2.1.4" )

