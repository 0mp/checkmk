title: Check state of NTP peers
agents: linux
author: Mathias Kettner <mk@mathias-kettner.de>
license: GPL
distribution: check_mk
description:
 This check uses the output of {ntpq -p} as sent by the agent. It is
 a list of all NTP peers with their state, stratum, offset and jitter.
 The check gets critical if the time offset exceeds a configurable level,
 if the stratum is too high or if the peer is unreachable, detected 
 or otherwise inusable.

item:
 The name or IP address of the peer (first column in output of {ntpq -p}.

examples:
 # Set critical stratum to 3, global warning/critical levels to 5.0 and 10.0 ms
 ntp_default_levels = (3, 5.0, 10.0)

perfdata:
 Two variables: the time {offset} to the peer in milliseconds and the
 {jitter} in ms.

inventory:
 Checks are created for all peers which have been contacted at least once.

[parameters]
critical_stratum (int): The stratum at which the check gets critical
warning (float): The offset in ms at which a warning is triggered
critical (float): the critical offset in ms

[configuration]
ntp_default_levels (int, float, float): The global default levels for all checks
 of this type. This is preset to {(10, 20.0, 50.0)} (which means that the check
 gets critical if the stratum is {10} or higher).
