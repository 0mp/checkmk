title: Monitor traffic and status of network interfaces via standard MIB
agents: snmp
author: Mathias Kettner <mk@mathias-kettner.de>
license: GPL
distribution: check_mk
description:
 This check monitors the operational status, link speed, traffic, packet
 counts, discards and errors of network interfaces by using the information
 provided by the standard SNMP MIB {.1.3.6.1.2.1.2.2} ({IF-MIB::ifTable}).

 The check's result is critical if the port status is not {up} or if the number
 of errors plus discards exceeds a configurable level or if the configured
 link speed differs from the target speed (for example if the interface
 falls back from 1Gb/s to 100Mb/s).

item:
 A string: Either the name of the interface as in {.1.3.6.1.2.1.2.2.1.2} ({IF-MIB::ifDescr}) or
 the index as in {.1.3.6.1.2.1.2.2.1.1} ({IF-MIB::ifIndex}). The index of the first
 port is usually {"1"}. Using names as items can be useful when monitoring operating systems where
 the names are fixed but the order of the interfaces varies over the time.

inventory:
 For each interface found up and of the type {ethernetCsmacd} (this is configurable) one
 check is created. The current speed of the interface is used as target speed in the check
 parameter.

perfdata:
 {in}: The number of bytes received per second.
 {inucast}: The number of unicast packets received per second.
 {innucast}: The number of broadcast and multicast packets per second.
 {indisc}: The number of discarded received packets per second.
 {inerr}: The number of input errors per second.
 {out}: The number of bytes sent per second.
 {outucast}: The number of unicast packets sent per second.
 {outnucast}: The number of broadcast and multicast packets sent per second.
 {outdisc}: The number of output packets discarded per second.
 {outerr}: The number of output errors per second.
 {outqlen}: The current length of the output queue.

[parameters]
err_warn (float): The percentage of errors + discards at which a warning should be
                  triggered. Default is {0.01} percent (one of 10.000).
err_crit (float): The percentage of errors + discards at which a critical state is
                  reached. Default is {0.1} percent (one of 1.000).
targetspeed (int): The target speed in bits per second of the interface.
err_warn (float): Optional: The in/out rate to raise a WARNING state. Defaults to {None}.
err_crit (float): Optional: The in/out rate to raise a CRITICAL state. Defaults to {None}.

[configuration]
if_inventory_porttypes (list of strings): List of interface types the inventory should create checks for.
  Default is {[ "ethernetCsmacd" ]}.
if_inventory_uses_description (boolean): Wether inventory should use the interface description as item (instead
  of the interface index). Default is {False}.
if_default_levels (float, float, float, float): 
  First two values: Warning and critical percentages (not rates!) for errors
  and discards used by intentorized checks.
  Last two values: Warning and critical rates for the bandwidth usage. Used by the new inventorized checks.
  Default is {(0.01, 0.1, None, None)}
