title: Established TCP Connections or TCP/UDP Listeners
agents: windows
catalog: os/networking
license: GPL
distribution: check_mk
description:
  This check evaluates the output of the {netstat -an} command on windows
  and checks if there are established connections or listeners
  matching a given criteria.

  The check returns {OK} state if the specified connection/listener is present,
  and {CRIT} if not.

  This check needs the agent plugin {netstat_an.bat} to be installed.

item:
  A user defined identifier of the connection.

examples:
  # Make sure that a connection from 192.168.0.1 is established
  # to the host winsrv1 (192.168.0.2) on port 445:
  checks += [
    ( 'winsrv1', 'win_netstat', 'My Test Connection',
       {
        'local_ip'  : '192.168.0.2',
        'local_port': 445,
        'remote_ip' : '192.168.0.1',
        'state'     : 'ESTABLISHED',
        'proto'     : 'TCP'
       }
    ),
  ]

  # Check if TCP port 80 is listening
  checks += [
    ( 'websrv1', 'win_netstat', 'HTTP Listener',
         {
          'local_port': 80,
          'state'     : 'LISTEN',
          'proto'     : 'TCP'
         },
    ),
  ]

