#!/bin/bash

if [ ! -e "$1" ] ; then 
    echo "Usage: $0 check_mk-...tar.gz" >&2
    exit 1
fi

tar tzf $1 | \
while read filename
do
  echo -n "$filename"
  if [ "${filename:(-7)}" = ".tar.gz" ] ; then
    echo :
    tar xzf $1 --to-stdout "$filename" | tar tzvf - 
    echo
  elif [ "${filename:(-4)}" = ".tar" ] ; then
    echo :
    tar xzf $1 --to-stdout "$filename" | tar tvf - 
    echo
  else
    echo
  fi
done

